/*! jQuery Element Diff - v0.1.0 - 2013-09-01
 * https://github.com/ngs/jquery-elementDiff
 * Copyright (c) 2013 Atsushi Nagase; Licensed MIT */
!function(){!function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n;return k=a.map,f=a.extend,h=a.inArray,l=a.merge,e=function(a){return f({},a)},i=function(a){var b;if(!a||"object"!=typeof a)return!1;for(b in a)if(Object.prototype.hasOwnProperty.call(a,b))return!1;return!0},c=/^(string|number|boolean|undefined)$/,j=function(a){return!a||c.test(typeof a)||a instanceof Array},m=function(a){var b,c;if(j(a))return null;for(b in a)c=a[b],a[b]=m(c);return a},d=function(a,b){var c,g,h,k,l;a=e(a),b=e(b),c={};for(g in a)k=a[g],l=b[g],delete b[g],j(l)&&j(k)?l!==k&&(c[g]=l):"object"==typeof l?(h=d(k,l),i(h)||(c[g]=h)):c[g]=m(k);return f(c,b)},g=function(a,b,c){var d,e;null==b&&(b={}),null==c&&(c=null);for(d in a)e=a[d],"_"===d?d=c:c&&(d=""+c+"-"+d),j(e)?b[d]=e:g(e,b,d);return b},n=function(b){var c;return c=a("<div />").append(b.clone()),a.trim(c.html()).replace(/\s*\n\s*/g,"")},b=function(){function b(a,b){"undefined"==typeof b&&(b=a.selector),this.element=a,this.selector=b}return b.prototype.toString=function(){return"[ElementDiff: "+(this.selector||this.element[0])+"]"},b.diffObjects=d,b.flattenAttributes=g,b.isEmptyObject=i,b.nullDeeply=m,b.outerHTML=n,b.prototype.generateCode=function(a){var b,c;return b=l([],arguments).slice(1),c=k(b,function(a){return JSON.stringify(a)}).join(","),""+a+"("+c+")"},b.prototype.diffAttributes=function(b){var c,e,f,h,j;b=a(b),c=this.element.attr(),e=b.attr(),f=g(d(c,e));for(h in f)j=f[h],void 0===j&&(f[h]=null);return i(f)?[]:[this.generateCode("attr",f)]},b.prototype.diffText=function(b){var c,d,e,f,g,h,i,j;return f=this.element,b=a(b),c=f.children(),d=b.children(),g=c.size(),h=d.size(),i=f.text(),j=b.text(),e=[],0===h&&i!==j?(g>0&&e.push(this.generateCode("empty")),e.push(this.generateCode("text",j)),e):e},b.prototype.isSameTag=function(b){return this.element.prop("nodeName")===a(b).prop("nodeName")},b.prototype.diff=function(b){var c,d,e;return e=this.element,b=a(b),b&&b.size()?(d=[],this.isSameTag(b)?(l(d,this.diffAttributes(b)),l(d,this.diffText(b))):d.push(this.generateCode("replaceWith",n(b))),d.length?(c=d.join("."),this.selector?['$("'+this.selector+'").'+c]:[c]):[]):[]},b.prototype.diffRecursive=function(c){var d,e,f,g,h,i,j,k,m,o;if(k=this,g=k.element,c=a(c),i=k.diff(c),/\.(empty|replaceWith)\(/.test(i[0]))return i;for(f=[],j=k.selector,d=g.children(),e=c.children(),m=d.size(),o=e.size(),e.each(function(c){var g,h,i;return g=a(d[c]),h=a(e[c]),i=""+j+" > :eq("+c+")",g.size()?l(f,new b(g,i).diffRecursive(h)):f.push('$("'+j+'").'+k.generateCode("append",n(h)))}),h=m;h>o;)f.push('$("'+j+" > :eq("+--h+')").'+k.generateCode("remove"));return l(f,i),f},b}(),a.elementDiff=b,a.fn.elementDiff=function(a){return new b(this,a)},a.fn.getElementDiff=function(a,b){return this.elementDiff(b).diffRecursive(a)},this}(jQuery)}.call(this);