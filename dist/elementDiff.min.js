/*! jQuery Element Diff - v0.1.0 - 2013-09-01
 * https://github.com/ngs/jquery-elementDiff
 * Copyright (c) 2013 Atsushi Nagase; Licensed MIT */
!function(){!function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;return c="\n",o=a.map,g=a.extend,l=a.inArray,p=a.merge,t=a.trim,f=function(a){return g({},a)},m=function(a){var b;if(!a||"object"!=typeof a)return!1;for(b in a)if(Object.prototype.hasOwnProperty.call(a,b))return!1;return!0},j=function(a){var b;return b=a.contents().filter(function(){return 3===this.nodeType&&t(this.data)}).get(),o(b,function(a){return t(a.data)})},k=function(a){return j(a).length>0},i=function(a){return'$("'+a+'")'},s=function(a,b){return""+a+" > :eq("+b+")"},d=/^(string|number|boolean|undefined)$/,n=function(a){return!a||d.test(typeof a)||a instanceof Array},q=function(a){var b,c;if(n(a))return null;for(b in a)c=a[b],a[b]=q(c);return a},e=function(a,b){var c,d,h,i,j;a=f(a),b=f(b),c={};for(d in a)i=a[d],j=b[d],delete b[d],n(j)&&n(i)?j!==i&&(c[d]=j):"object"==typeof j?(h=e(i,j),m(h)||(c[d]=h)):c[d]=q(i);return g(c,b)},h=function(a,b,c){var d,e;null==b&&(b={}),null==c&&(c=null);for(d in a)e=a[d],"_"===d?d=c:c&&(d=""+c+"-"+d),n(e)?b[d]=e:h(e,b,d);return b},r=function(b){var c;return c=a("<div />").append(b.clone()),t(c.html()).replace(/>\s*\n\s*</g,"><")},b=function(){function b(a,b){"undefined"==typeof b&&(b=a.selector),this.element=a,this.selector=b}return b.prototype.toString=function(){return"[ElementDiff: "+(this.selector||this.element[0])+"]"},b.diffObjects=e,b.flattenAttributes=h,b.getTextContents=j,b.hasTextNode=k,b.isEmptyObject=m,b.nullDeeply=q,b.outerHTML=r,b.prototype.hasTextDiff=function(b){var d,e;return d=j(a(this.element)),e=j(a(b)),d.join(c)!==e.join(c)},b.prototype.generateCode=function(a){var b,c;return b=p([],arguments).slice(1),c=o(b,function(a){return JSON.stringify(a)}).join(","),""+a+"("+c+")"},b.prototype.diffAttributes=function(b){var c,d,f,g,i;b=a(b),c=this.element.attr(),d=b.attr(),f=h(e(c,d));for(g in f)i=f[g],void 0===i&&(f[g]=null);return m(f)?[]:[this.generateCode("attr",f)]},b.prototype.diffText=function(b){var c,d,e,f,g,h,i,j;return f=this.element,b=a(b),c=f.children(),d=b.children(),i=c.size(),j=d.size(),g=f.html(),h=b.html(),e=[],this.hasTextDiff(b)?(e.push(this.generateCode("html",h)),e):e},b.prototype.isSameTag=function(b){var c;return c="nodeName",this.element.prop(c)===a(b).prop(c)},b.prototype.diff=function(b){var c,d,e;return e=this.element,b=a(b),b&&b.size()?(d=[],this.isSameTag(b)?(p(d,this.diffAttributes(b)),p(d,this.diffText(b))):d.push(this.generateCode("replaceWith",r(b))),d.length?(c=d.join("."),this.selector?[""+i(this.selector)+"."+c]:[c]):[]):[]},b.prototype.diffRecursive=function(c){var d,e,f,g,h,j,k,l,m,n;if(l=this,g=l.element,c=a(c),j=l.diff(c),/\.(empty|replaceWith|html)\(/.test(j[0]))return j;for(f=[],k=l.selector,d=g.children(),e=c.children(),m=d.size(),n=e.size(),e.each(function(c){var g,h;return g=a(d[c]),h=a(e[c]),g.size()?p(f,new b(g,s(k,c)).diffRecursive(h)):f.push(""+i(k)+"."+l.generateCode("append",r(h)))}),h=m;h>n;)f.push(""+i(s(k,--h))+"."+l.generateCode("remove"));return p(f,j),f},b}(),a.elementDiff=b,g(a.fn,{elementDiff:function(a){return new b(this,a)},getElementDiff:function(a,b){return this.elementDiff(b).diffRecursive(a)}}),this}(jQuery)}.call(this);